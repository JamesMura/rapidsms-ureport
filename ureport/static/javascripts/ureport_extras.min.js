(function(d){d.PeriodicalUpdater=function(i,b){function a(){f(settings.url+(new Date).getTime(),settings.sendData,function(c){b&&b(c);PeriodicalTimer=setTimeout(a,settings.minTimeout)},settings.type)}settings=jQuery.extend({url:"",method:"get",sendData:"",minTimeout:15E3,maxTimeout:15E3,multiplier:1,type:"text"},i);f="post"==settings.method||"POST"==settings.method?d.post:d.get;settings.multiplier=1>settings.multiplier?1:settings.multiplier;a()}})(jQuery);
(function(d,i){var b;d.ureport=b={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not(button[type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",
requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input:file",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(a){var c=d('meta[name="csrf-token"]').attr("content");c&&a.setRequestHeader("X-CSRF-Token",c)},fire:function(a,c,b){c=d.Event(c);a.trigger(c,b);return!1!==c.result},confirm:function(a){return confirm(a)},ajax:function(a){return d.ajax(a)},href:function(a){return a.attr("href")},handleRemote:function(a){var c,
g,e,h,j;if(b.fire(a,"ajax:before")){h=a.data("cross-domain")||null;j=a.data("type")||d.ajaxSettings&&d.ajaxSettings.dataType;if(a.is("form")){c=a.attr("method");g=a.attr("action");e=a.serializeArray();var k=a.data("ujs:submit-button");k&&(e.push(k),a.data("ujs:submit-button",null))}else a.is(b.inputChangeSelector)?(c=a.data("method"),g=a.data("url"),e=a.serialize(),a.data("params")&&(e=e+"&"+a.data("params"))):(c=a.data("method"),g=b.href(a),e=a.data("params")||null);c={type:c||"GET",data:e,dataType:j,
crossDomain:h,beforeSend:function(c,d){d.dataType===i&&c.setRequestHeader("accept","*/*;q=0.5, "+d.accepts.script);return b.fire(a,"ajax:beforeSend",[c,d])},success:function(c,b,d){a.trigger("ajax:success",[c,b,d])},complete:function(c,b){a.trigger("ajax:complete",[c,b])},error:function(c,b,d){a.trigger("ajax:error",[c,b,d])}};g&&(c.url=g);return b.ajax(c)}return!1},handleMethod:function(a){var c=b.href(a),g=a.data("method"),a=a.attr("target"),e=d("meta[name=csrf-token]").attr("content"),h=d("meta[name=csrf-param]").attr("content"),
c=d('<form method="post" action="'+c+'"></form>'),g='<input name="_method" value="'+g+'" type="hidden" />';h!==i&&e!==i&&(g+='<input name="'+h+'" value="'+e+'" type="hidden" />');a&&c.attr("target",a);c.hide().append(g).appendTo("body");c.submit()},disableFormElements:function(a){a.find(b.disableSelector).each(function(){var a=d(this),b=a.is("button")?"html":"val";a.data("ujs:enable-with",a[b]());a[b](a.data("disable-with"));a.prop("disabled",!0)})},enableFormElements:function(a){a.find(b.enableSelector).each(function(){var a=
d(this),b=a.is("button")?"html":"val";if(a.data("ujs:enable-with"))a[b](a.data("ujs:enable-with"));a.prop("disabled",!1)})},allowAction:function(a){var c=a.data("confirm"),d=!1,e;if(!c)return!0;b.fire(a,"confirm")&&(d=b.confirm(c),e=b.fire(a,"confirm:complete",[d]));return d&&e},blankInputs:function(a,c,b){var e=d(),h;a.find(c||"input,textarea").each(function(){h=d(this);if(b?h.val():!h.val())e=e.add(h)});return e.length?e:!1},nonBlankInputs:function(a,c){return b.blankInputs(a,c,!0)},stopEverything:function(a){d(a.target).trigger("ujs:everythingStopped");
a.stopImmediatePropagation();return!1},callFormSubmitBindings:function(a,c){var b=a.data("events"),e=!0;b!==i&&b.submit!==i&&d.each(b.submit,function(a,b){if("function"===typeof b.handler)return e=b.handler(c)});return e},disableElement:function(a){a.data("ujs:enable-with",a.html());a.html(a.data("disable-with"));a.bind("click.ureportDisable",function(a){return b.stopEverything(a)})},enableElement:function(a){a.data("ujs:enable-with")!==i&&(a.html(a.data("ujs:enable-with")),a.data("ujs:enable-with",
!1));a.unbind("click.ureportDisable")}};d.ajaxPrefilter(function(a,c,d){a.crossDomain||b.CSRFProtection(d)});d(document).delegate(b.linkDisableSelector,"ajax:complete",function(){b.enableElement(d(this))});d(document).delegate(b.linkClickSelector,"click.ureport",function(a){var c=d(this),g=c.data("method"),e=c.data("params");if(!b.allowAction(c))return b.stopEverything(a);c.is(b.linkDisableSelector)&&b.disableElement(c);if(c.data("remote")!==i){if((a.metaKey||a.ctrlKey)&&(!g||"GET"===g)&&!e)return!0;
!1===b.handleRemote(c)&&b.enableElement(c);return!1}if(c.data("method"))return b.handleMethod(c),!1});d(document).delegate(b.inputChangeSelector,"change.ureport",function(a){var c=d(this);if(!b.allowAction(c))return b.stopEverything(a);b.handleRemote(c);return!1});d(document).delegate(b.formSubmitSelector,"submit.ureport",function(a){var c=d(this),g=c.data("remote")!==i,e=b.blankInputs(c,b.requiredInputSelector),h=b.nonBlankInputs(c,b.fileInputSelector);if(!b.allowAction(c)||e&&c.attr("novalidate")==
i&&b.fire(c,"ajax:aborted:required",[e]))return b.stopEverything(a);if(g){if(h)return b.fire(c,"ajax:aborted:file",[h]);if(!d.support.submitBubbles&&"1.7">d().jquery&&!1===b.callFormSubmitBindings(c,a))return b.stopEverything(a);b.handleRemote(c);return!1}setTimeout(function(){b.disableFormElements(c)},13)});d(document).delegate(b.formInputClickSelector,"click.ureport",function(a){var c=d(this);if(!b.allowAction(c))return b.stopEverything(a);a=(a=c.attr("name"))?{name:a,value:c.val()}:null;c.closest("form").data("ujs:submit-button",
a)});d(document).delegate(b.formSubmitSelector,"ajax:beforeSend.ureport",function(a){this==a.target&&b.disableFormElements(d(this))});d(document).delegate(b.formSubmitSelector,"ajax:complete.ureport",function(a){this==a.target&&b.enableFormElements(d(this))})})(jQuery);