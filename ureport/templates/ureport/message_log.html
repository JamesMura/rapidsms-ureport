{% extends "layout.html" %}

{% block title %}Message Log - {{ block.super }}{% endblock %}

{% block stylesheets %}
{{ block.super }}
   <link type="text/css" rel="stylesheet" href="{{ MEDIA_URL }}rapidsms_httprouter/stylesheets/console.css" /> 
{% endblock %}

{% block content %}
<div class="sender module">
  <h2>Send Message</h2>
  <form method="POST" class="sender-form">
    {{ reply_form }}
    <input type="submit" value="send" />
    {% csrf_token %}
  </form>
  <script language="javascript">
    function reply(number, message_pk) {
        $('#id_recipient').val(number);
        $('#id_in_response_to').val(message_pk);
        return void(0);
    }
  </script>
</div>

<div class="messages module">
    <h2>Mass Messages</h2>
    <table>
        <thead>
            <th>Message</th>
            <th>Time</th>
            <th>User</th>
            <th>Recipients</th>
            <th>Type</th>
            <!-- p.question, p.start_date, p.user, p.contacts -->
        </thead>
        {% for text, date, user, contacts, is_poll in mass_messages %}
        <tr>
            <td>{{ text }}</td>
            <td>{{ date|date:"m/d/Y H:i:s" }}</td>
            <td>{{ user.username }}</td>
            <td>{{ contacts.count }} recipient{{ contacts.count|pluralize }}</td>
            <td>{% if is_poll %}Poll message{% else %}Mass text{% endif %}</td>
        </tr>
        {% endfor %}
    </table>
</div>

<div class="messages module">
    <h2>Message Log</h2>
    {{ messages_table.as_html }}
</div>
{% endblock %}
